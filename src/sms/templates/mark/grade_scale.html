{% extends 'base.html' %}
{% load static crispy_forms_tags %}

{% block title %} Grade Scale Setting {% endblock title %}
{% block main %}
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@simonwep/pickr/dist/themes/nano.min.css"/> <!-- 'nano' theme -->
<div style="margin-bottom: 180px" class="container-fluid">
      <section>
              <div class="card mb-4 wow fadeIn">
         <!--Card content-->
         <div class="card-body d-sm-flex justify-content-between">
            <h6 class="mb-2 mb-sm-0 pt-1">
               <a href="{% url 'home_page' %}">Home Page</a>
               <span>/</span>
               <span>Grade Scale</span>
            </h6>
         </div>
      </div>
                 <div class="row">
            <div class="col-md-5">
              <a href="" class="btn btn-info new" data-toggle="modal" data-target="#modalSubscription">Setup New Grade Scale</a>
            </div></div>
        <div class="my-5"></div>

        <div class="card">
          <div class="card-body">

            <!--Table-->
            <table class="table">

              <!--Table head-->
              <thead class="mdb-color darken-3">
                <tr class="text-white">
                  <th>#</th>
                  <th>Section</th>
                  <th>Grade</th>
                  <th>Mark From</th>
                  <th>Mark Upto</th>
                  <th>Remark</th>
                  <th>Action</th>
                </tr>
              </thead>
              <tbody>
                {% for scale in object_list %}
                <tr>
                  <th scope="row">{{ forloop.counter }}</th>
                  <td>{{ scale.section }}</td>
                  <td>{{ scale.grade|upper }}</td>
                  <td>{{ scale.mark_from }}</td>
                  <td>{{ scale.mark_upto }}</td>
                  <td>{{ scale.remark }}</td>
                  <td>
                    <a href="{% url 'edit_grade_scale' pk=scale.pk %}" data-toggle="tooltip" title="Click on Setup new payment and select the class to update it" class="teal-text"><i class="fa fa-pen"></i></a>
                    <form method="post" action="{% url 'delete_grade_scale' pk=scale.pk %}">{% csrf_token %}
                      <button data-toggle="tooltip" title="Click on Setup new payment and select the class to update it" class="teal-text"><i class="fa fa-times"></i></button>
                    </form>
                  </td>
                </tr>
                {% endfor %}
              </tbody>
            </table>
          </div>
        </div>
      </section>
    </div>
    <!--Modal: setup new payment Form-->
    <form method="post" id="form" form-modal-url="{% url 'grade_scale_modal' %}" action="{% url 'set_grade_scale' %}">{% csrf_token %}
        <div class="modal fade" id="modalSubscription" tabindex="-1" role="dialog" aria-labelledby="myModalLabel"
          aria-hidden="true">
          <div class="modal-dialog cascading-modal" role="document">
            <!--Content-->
            <div class="modal-content">

              <!--Header-->
              <div class="modal-header mdb-color darken-3 white-text">
                <h4 class=""> Grade Setup</h4>
                <button type="button" class="close waves-effect waves-light" data-dismiss="modal" aria-label="Close">
                  <span aria-hidden="true">&times;</span>
                </button>
              </div>
              <!--Body-->
              <div class="modal-body mb-0">
                  {{ form|crispy }}
                <div hidden id="loader" class="progress md-progress primary-color-dark">
                  <div class="indeterminate">
                  </div>
              </div>
              </div>
            </div>
            <!--/.Content-->
          </div>
        </div>
    </form>
        <!--Modal: Subscription From-->
{% endblock main %}

{% block script %}

<!-- Modern or es5 bundle -->
<script src="https://cdn.jsdelivr.net/npm/@simonwep/pickr/dist/pickr.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@simonwep/pickr/dist/pickr.es5.min.js"></script>

<script type="text/javascript">
$(document).ready(function function_name(argument) {
  var url = $('#form').attr('form-modal-url');
  var csrf_token = $('input[name="csrfmiddlewaretoken"]').val();
  $('.new').on('click', function(){
    $.ajax({
    url: url,

    beforeSend: function(){
      $("#loader").removeAttr('hidden');
    },

    complete: function(){
      $("#loader").attr('hidden', 'hidden');
    },

    success: function (data) {
      $(".modal-body").html(data);
    }});
  });


  const pickr3 = new Pickr({
  el: '#id_color',
  theme: 'nano',
  useAsButton: true,
  default: "000000",
  components: {
    preview: true,
    opacity: true,
    hue: true,

    interaction: {
      hex: true,
      rgba: true,
      hsla: true,
      hsva: true,
      cmyk: true,
      input: true,
      clear: true,
      save: true
    }
  },

  onChange(hsva, instance) {
    $('#id_color').val( hsva.toRGBA().toString());
  }
});
});
</script>

{% endblock script %}
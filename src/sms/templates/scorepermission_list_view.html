{% extends 'base.html' %}
{% load static crispy_forms_tags %}

{% block title %} Mark Permission {% endblock title %}

{% block main %}
    <div class="container-fluid">
               <!-- Heading -->
   <div class="card mb-4 wow fadeIn">
      <!--Card content-->
      <div class="card-body d-sm-flex justify-content-between">
         <h6 class="mb-2 mb-sm-0 pt-1">
            <a href="{% url 'home_page' %}">Home Page</a>
            <span>/</span>
            <span>Score Permission</span>
         </h6>
      </div>
   </div>
   <!-- Heading -->
    <div hidden id="loader" class="progress md-progress primary-color-dark">
      <div class="indeterminate">
    </div>
  </div>
      <!--Section: Basic examples-->
      <span id="form-url" form-url="{% url 'create_mark_permission' %}"></span>
      <section>
        <ul class="nav nav-tabs" id="myTab" role="tablist">
         {% for section in sections %}
        <li class="nav-item">
          <a class="nav-link section {% if section.pk == 1 %} active {% endif %}" id="{{ section.pk }}" data-toggle="tab" href="" role="tab" aria-controls="home"
            aria-selected="true">{{ section }}</a>
        </li>
  {% empty %}
  <ul class="nav nav-tabs" id="myTab" role="tablist">
  <span class="alert alert-info">Create sections to begin </span>
  </ul>
   {% endfor %}
   </ul>
  <div class="tab-content" id="loadData">
    <div class="tab-pane fade show active" id="home" role="tabpanel" aria-labelledby="home-tab">
      <!--Grid row-->
  <div class="row">
  <!--Grid column-->
  <div class="col-md-6 mb-4">
    {% if sections %}
<form method="POST" action="{% url 'create_mark_permission' %}">{% csrf_token %}
  <input type="text" hidden name="section" value="{{ selected_section }}">
  {% for form in form %}
    {{ form|as_crispy_field }}
  {% endfor %}
  <button class="btn btn-sm btn-primary">Save</button>
</form>
{% endif %}
</div>
<!--Grid row-->
  </div>
</div>
</section>
      <!--Section: Basic examples-->

  {% endblock main %}
  {% block script %}
  <script src="{% static 'js/datepicker.js' %}"></script>
  <script type="text/javascript">
    $(document).ready(function(){
      var url = $('#form-url').attr('form-url');

      function getForm(id){
        alert(id)
        $.ajax({
          url: url,

          data: {'pk': id},

          beforeSend: function(){
            $("#loader").removeAttr('hidden');
          },


          complete: function(){
            $("#loader").attr('hidden', 'hidden');
          },

          success: function (data) {
            $("#loadData").html(data);
          }
        });
      }

      //getForm(1);

      $('.section').on('click', function(){
        getForm($(this).attr('id'));
        console.log($('#id_section').val());
      });
  });
  </script>
  {% endblock script %}

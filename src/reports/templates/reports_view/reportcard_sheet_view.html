{% extends 'base.html' %}
{% load static %}
{% block title %} Students Report {% endblock title %}
{% block main %}
   <!-- Heading -->

   <div class="container-fluid">
   <!-- Heading -->
   <div class="card mb-4 wow fadeIn">
      <!--Card content-->
      <div class="card-body d-sm-flex justify-content-between">
         <h6 class="mb-2 mb-sm-0 pt-1">
            <a href="{% url 'home_page' %}">Home Page</a>
            <span>/</span>
            <span>Students Report</span>
         </h6>
      </div>
   </div>
   <!-- Heading -->
   <!-- Editable table -->
   <div class="card">
      <h6 class="mdb-color darken-3 card-header text-center white-text text-uppercase py-2">Students Report</h6>
      <div class="container">
         <form id="form" data-batch-url="{% url 'ajax_load_batches' %}" method="post" action="{% url 'report_student' %}">{% csrf_token %}
         <div class="row">

            <div class="col-md-3">
            <select name="term"
            class="mdb-select colorful-select dropdown-primary mx-2 md-form mt-3 md-dropdown">
              <option value="" disabled selected>Selet term</option>
               <option value="First">First</option>
               <option value="Second">Second</option>
               <option value="Third">Third</option>
            </select>
            </div>
            <div class="col-md-4">
               <select name="class" id="id_class" class="mdb-select colorful-select dropdown-primary mx-2 md-form mt-3 md-dropdown">
              <option value="" disabled selected>Select Class</option>
              {% for class in classes %}
                <option value="{{class.pk}}">{{ class }}</option>
               {{ class }}
              {% endfor %}
           </select>
            </div>
              <div class="col-md-4">
               <select name="batch" id="id_batch" class="mdb-select colorful-select dropdown-primary mx-2 md-form mt-3 md-dropdown">
              <option value="" disabled selected>Select a batch</option>
            </select>
            </div>
            <div class="col-md-5">
               <input type="submit" name="submit" class="btn btn-info" value="Generate PDF">
            </div>
         </div>
          </form>
      </div>
      <div style="margin-bottom: 190px" class="card-body">
         <div id="table" class="table-editable">
            <!-- <table class="table table-bordered table-responsive-md table-striped text-center">
               <tr>
                  <th class="text-center">Fullname</th>
                  <th class="text-center">Picture</th>
                  <th class="text-center">Roll</th>
                  <th class="text-center">Email</th>
                  <th class="text-center">Status</th>
                  <th class="text-center">Action</th>
               </tr>
            </table> -->
         </div>
      </div>
   </div>
</div>
{% block script %}

<script type="text/javascript">
     $("#id_class").change(function(){
      var class_id = $(this).val()
      console.log(class_id)
       var get_batches_url = $("#form").attr("data-batch-url");

      $.ajax({
        url: get_batches_url,
        data: {
          'class': class_id
        },

        beforeSend: function(){
          $("#loader").removeAttr('hidden');
        },

        complete: function(){
          $("#loader").attr('hidden', 'hidden');
        },

        success: function (data) { 
          $("#id_batch").html(data);
          console.log(data);
          $('.batch_div').fadeIn(1000).removeAttr('hidden');
        }

      });
    });

</script>
{% endblock %}
{% endblock main %}